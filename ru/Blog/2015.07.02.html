<!DOCTYPE html>
<html lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<font face="Verdana, sans-serif">
  <head>
    <title>Tesla Music Band - Experimental Music Performance</title>
    
    
</head>
<body>
<p><a href="http://teslamusicband.com/ru/index.html">На главную</a> <a href="http://teslamusicband.com/ru/Blog/index.html">К оглавлению блога</a></p>

<p><a href="https://www.youtube.com/watch?v=aEEF6w5xyMQ" target="_blank"> <img src="http://www.teslamusicband.com/images/Blog/2015.07.02.jpg"/></a></p>

Год второй, месяц десятый, день девятнадцатый

Первый нормальный тест моей новой и теперь горячо любимой камеры Blackmagic 4k
При практическом ковырянии стало очевидно, что хорошие кадры начинают получаться когда ISO минимален (на этом видео ASA=200, хотя камера может в пределах от 200 до 800 с шагом удвоения предыдущего значения), а диафрагма объектива максимально открыта (у меня это T1.5), хреновенько немного то что тогда увеличивается глубина резкости, и надо внимательнее следить за фокусом, т.к. он становится для очень небольшого по длине участка пространства из-за глубины резкости, однако это просто я увалень чтоб такое говорить, и колосс раздела физики - оптики мне разумеется не виноват, что так происходит. Наоборот, довольно интересна художественность размытия от центра объектива, почему бы и нет.

Другой очень важный фактор то, что 12-битный RAW в контейнере CinemaDNG нихера не панацея для цветокоррекции по сравнению с файлом который мы получаем из потребительских гаджетов и мы сейчас с вами рассмотрим это на примере, который вы сами сможете проверить. Чтобы проверить пример скачайте где-нибудь CinemaDNG RAW с 12-битной глубиной цвета и сделайте у себя то, что сделал я. И так, получая с сенсора RAW, мы получаем значения напряжений фотодиодов матрицы сенсора. Значения содержатся только для яркости конкретного фотодиода. Воспринимаемая фотодиодом яркость при идеальных условиях преобразования - число с плавающей запятой, т.е. это значение напряжения существует в бесконечной точности пока оно существует до АЦП. Как только через АЦП прошло значение напряжения оно округляется с определённой точностью, квантуется от полного отсутствия до полного наличия света битностью слова. Битность здесь это ёмкость ячейки памяти в битах в которую можно слово положить. Таким образом градиент яркости квантуется четырьмя битами в 16 значений яркости одного цвета, а затем 16 значений яркости трёх основных цветов комбинируются в 4096 оттенков. Это трюковато, потому что 12-битной получается не глубина цвета, а диапазон яркости трёх разных цветов. Причём, на отдельный основной цвет выделяется совсем не 12 бит, а происходит распределение согласно RGB палитре. RGB палитра состоит из мозаики с двумя квадратами зелёного цвета, расположенными друг против друга по диагонали и дополненных синим и красным квадратом и когда свет отражается от объекта имеющего цвет и выделяется основной тон цвета - волна определённой длинны, то она фильтруется так называемым фильтром Байера. Фильтр байера это RGB мозаика из светофильтров содержащих по одному основному цвету, расположенная перед фотодиодами матрицы таким образом что значение яркости фотодиод сенсора получает не для каждого цвета, а только для одного из трёх цветов. полная RGB ячейка состоящая из двух зелёных и красного с синим цветов покрывает область из четырёх разных фотодиодов и информацию о цвете объекта получают 4 светодиода вместо одного, что в 4 раза снижает реальное разрешение матрицы, либо делит на 3 информацию о цвете в пересчёте на пиксел. в 4 раза снижает, если воспринимать RGB ячейку, как объект, и делит на три в пересчёте на пиксел потому что свет проходящий через одну из трёх ячеек даёт фотодиоду информацию только по одному из трёх цветов. 1\3 потеря цветовой информации — это большая проблема, в основном потому, что это большой шаг в отступлении от настоящего восприятия цвета. Таким образом, для каждого фотодиода согласно RGB палитре отводится только по 4 бита информации. (12 бит делится на 3 цвета). Мы получаем не 12 битную глубину цвета, а 4 битную. Разница всего на 1 бит для каждого цвета между 8 и 12 битами, даёт очень большой разрыв между 256 оттенками цвета при 8 бит и 4096 оттенками при 12 бит, поэтому между 8-битным диапазоном и 12-битным выбор в 12-битном диапазоне и сенсора и палитры очевиден, и критичен. Однако, на выходе RAW 12 бит мы не получаем диапазон из 4096 математических оттенков по причине существования фильтра Байера на поверхности сенсора. RAW файл по-прежнему ограничен тем что информация о цвете на единице площади из 4 пикселей находится геометрически в разных местах, и нам нужно провести дебайеризацию. С помощью разных прог это можно сделать, например, с помощью RawTherapee. Дебайеризация заключается в том, чтобы разделив изображение на цвета воссоздать значение яркости соседних ячеек в слое одного цвета согласно среднему значению яркости соседних ячеек одного цвета и сохранить это в файл с уже тремя полными слоями цвета в палитре RGB. 
т.е. из одного слоя с 3\3 полного цвета где есть возможность присваивать значения только у 1\3 для каждого цвета, сделать три, получив возможность присваивать значения 3\3 для каждого цвета через расслоение трёхцветного слоя на три одноцветных и таким образом получить 3\3 цвета для полного цвета через восстановление 2\3 значений яркости цвета в каждом из 3-х слоёв каждого цвета. Однако, данная процедура не является точным восстановлением цветов потому что полученные из средних значений значения яркости не являются действительно существовавшими в реальности значениями яркости, но в силу малой площади фотодиода матрицы, разница между реальным и средним значением яркости ничтожна. 4096 оттенков, полученных в результате совмещения 4 битов каждого цвета из-за существования только одного основного цвета на единице площади с ячейками из 3-х цветов на сам бит даёт нам только 1365(3) оттенков и получается, что на единицу площади тогда отводится не 4, а 1(3) бита. Разобрав с помощью дебайеризации диапазон из математических 4096, но фактических 1365(3) оттенков заключённых в 4 битах для каждого цвета мы получаем три таких диапазона, т.е. 1365(3)*3~=4096, что только теперь даёт нам 12 бит на пиксель для трёх цветов но не в четырёх, а уже в каждом пикселе. Имея для каждого цвета не по 4, а по 12 бит цвета на единицу площади из четырёх пикселей теперь, принимая за пиксель величину равную единице площади состоящей из четырёх пикселей и деля на количество ячеек пикселов (4), с возможными разными значениями яркости, мы получаем четырёхкратную с точки зрения детализации и трёхкратную с точки зрения цвета, детализацию цвета, но по сути лишь восстановление той самой заявленной 4-х битности цвета из 1(3) или получение 4096 из по факту геометрически случившихся 1365(3) оттенков цвета. И вот, если говорить о RAW без учёта процесса дебайеризации, то заявленная 12-битность цвета – это грёбаный писькин праздник, потому что глубина цвета может быть лишь в отношении яркости в пересчёте на площадь, а именно в отношении яркости цвета площади поверхности фотодиода матрицы, и с фильтром байера, который на матрице присутствует, глубины цвета в 12 бит мы не получаем, такие дела. С другой стороны, ни один монитор пока (или может я просто не знаю) не воспроизводит все три цвета на пиксел потому что на выходе поверхности монитора стоит тот же фильтр Байера и глаз собирает с монитора изображение о цвете всегда согласно сложению яркости трёх основных RGB цветов, но вот для цветокоррекции это пиздецки важно. Иметь в распоряжении 4096 оттенков на пиксел вместо 1365(3) это значит не просрать насыщенность, которой можно различным образом пользоваться для художественного воплощения своих замыслов и идей. Есть конечно Foveon X-3, но он, к сожалению ограничен 5-ю кадрами в секунду и инерцию зрения преодолеть не может, если только добиваться её оптически, с помощью 5-тактного «Двигателя Фотоаппаратного Фоткания» ахахахах, для создания 25 кадрового видеоряда. Преодолеется сложность в синхронизации данных с матриц технологий CCD, т.к. кадр будет снят целиком на один сенсор, а не отдельные цвета кадра будут сняты на разные сенсоры. Тогда будет клёвенький такой инструмент для предельно точного отображения цветов, т.к. в матрице Foveon X-3 один пиксель площади хавает сразу три цвета благодаря светофильтру с 45-градусным преломлением и боковым фотодиодам повёрнутым на 90 градусов. Однако, в Foveon X-3 Rolling Shutter, поэтому при съёмке движущихся объектов получится говно и избежать хроматических аберраций важнее чем исключить ничтожную погрешность между средним и реальным значением яркости цвета.
Собственно, после обработки RAW при проведении цветокоррекции в процессе выбора LUT, а именно для выбора – каким ты хочешь чтобы выглядело твоё изображение, если ты суёшь RAW сразу в редактор без проведения дебайеризации, то в редакторе ты трёхкратно ограничен в цветовом разрешении, т.е. эффект от того или иного LUT будет в три раза меньше, если ты просто импортировал RAW потому что при наличии лишь 1\3 информации о цвете нельзя управлять значениями двух других отсутствующих цветов. Преобразование RAW с помощью, например, RawTherapee, позволяет преобразовать 12 битный RAW в 48 битный Uncompressed TIFF без цветовых или яркостных потерь для изображения и после этого стоит совать в редактор не RAW, а уже TIFF, так как LUT просто меняет значения яркости для конкретных цветов пикселя и если он не находит в пикселе синего или красного цвета, то он не меняет значений яркости для синего или красного цветов, поэтому конечное изображение выглядит гооовёненько... В общем, попробуйте скачать RAW какой-нибудь камеры которая пишет RAW, провести дебайеризацию в RawTherapee, затем в редакторе последовательно положить сначала RAW (c 1\3 цветовой информацией на пиксель), потом TIFF (c 3\3 цветовой информацией на пиксель), и наложить какой-нибудь одинаковый LUT на RAW и на TIFF и вы увидите разницу.  

(примечание: в видео расположенном в этом посте я специально поставил для контраста просто RAW без LUT и цветокоррекции и Uncompressed TIFF с цветокоррекцией и LUT, т.е. это не та разница которую я здесь описал. Разница, которую я описал - другая, но не менее существенная 
<a href="http://teslamusicband.com/ru/index.html">На главную</a></p>
</body>
</font>
</html>